/**
 * BottleJS v2.0.0 - 2020-08-20
 * A powerful dependency injection micro container
 *
 * Copyright (c) 2020 Stephen Young
 * Licensed MIT
 */

(function(f){"use strict";function e(t,e){var r=t[e];if(r===f&&x.config.strict)throw new Error("Bottle was unable to resolve a service.  `"+e+"` is undefined.");return r}function o(t){var e;return this.nested[t]||(e=x.pop(),this.nested[t]=e,this.factory(t,function(){return e.container})),this.nested[t]}function s(t){return t.split(y).reduce(e,this)}function h(t,e){return e(t)}function p(t,e){return(t[e]||[]).concat(t.__global__||[])}function n(c,e){this.id;var a=this.container,l=this.decorators,u=this.middlewares,d=c+$,t=Object.create(null);return t[d]={configurable:!0,enumerable:!0,get:function(){var t=new e;return delete a[d],a[d]=t}},t[c]={configurable:!0,enumerable:!0,get:function(){var t,i,e,n,r,o,s=a[d];return s&&(t=p(l,c).reduce(h,s.$get(a)),delete a[d],delete a[c]),t===f?t:(i=p(u,c),e=c,n=t,r=a,o={configurable:!0,enumerable:!0},i.length?o.get=function(){var e=0,r=function(t){if(t)throw t;i[e]&&i[e++](n,r)};return r(),n}:(o.value=n,o.writable=!0),Object.defineProperty(r,e,o),r[e])}},Object.defineProperties(a,t),this}function r(t,e){var r,i=t.split(y);if(!this.providerMap[t]||1!==i.length||this.container[t+$])return this.originalProviders[t]=e,this.providerMap[t]=!0,r=i.shift(),i.length?(o.call(this,r).provider(i.join(y),e),this):n.call(this,r,e)}function c(t,e){return r.call(this,t,function(){this.$get=e})}function i(t,r,i){var n=3<arguments.length?O.call(arguments,3):[],o=this;return c.call(this,t,function(){var t=r,e=n.map(s,o.container);return i?new(r.bind.apply(r,[null].concat(e))):t.apply(null,e)})}function a(t,e){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:e,writable:!0})}function l(t,e){var r=t[e];return r||a.call(t,e,r={}),r}function u(t,e){var r,i;return typeof t==w&&(e=t,t=j),i=(r=t.split(y)).shift(),r.length?o.call(this,i).decorator(r.join(y),e):(this.decorators[i]||(this.decorators[i]=[]),this.decorators[i].push(e)),this}function d(t){return!/^\$(?:decorator|register|list)$|Provider$/.test(t)}function v(t){return Object.keys(t||this.container||{}).filter(d)}function b(t){var e=t.$value===f?t:t.$value;return this[t.$type||"service"].apply(this,[t.$name,e].concat(t.$inject||[]))}function g(t){delete this.providerMap[t],delete this.container[t],delete this.container[t+$]}var y=".",w="function",m="string",j="__global__",$="Provider",P=0,O=Array.prototype.slice,_={},x=function t(e){if(!(this instanceof t))return t.pop(e);this.id=P++,this.decorators={},this.middlewares={},this.nested={},this.providerMap={},this.originalProviders={},this.deferred=[],this.container={$decorator:u.bind(this),$register:b.bind(this),$list:v.bind(this)}};x.prototype={constant:function(t,e){var r=t.split(y);return t=r.pop(),function(t,e){Object.defineProperty(this,t,{configurable:!1,enumerable:!0,value:e,writable:!1})}.call(r.reduce(l,this.container),t,e),this},decorator:u,defer:function(t){return this.deferred.push(t),this},digest:function(t){return(t||[]).map(s,this.container)},factory:c,instanceFactory:function(t,e){return c.call(this,t,function(t){return{instance:e.bind(e,t)}})},list:v,middleware:function(t,e){var r,i;return typeof t==w&&(e=t,t=j),i=(r=t.split(y)).shift(),r.length?o.call(this,i).middleware(r.join(y),e):(this.middlewares[i]||(this.middlewares[i]=[]),this.middlewares[i].push(e)),this},provider:r,resetProviders:function(r){var i=this.originalProviders,n=Array.isArray(r);Object.keys(this.originalProviders).forEach(function(t){var e;n&&-1===r.indexOf(t)||(1<(e=t.split(y)).length&&e.forEach(g,o.call(this,e[0])),g.call(this,t),this.provider(t,i[t]))},this)},register:b,resolve:function(e){return this.deferred.forEach(function(t){t(e)}),this},service:function(t,e){return i.apply(this,[t,e,!0].concat(O.call(arguments,2)))},serviceFactory:function(t,e){return i.apply(this,[t,e,!1].concat(O.call(arguments,2)))},value:function(t,e){var r=t.split(y);return t=r.pop(),a.call(r.reduce(l,this.container),t,e),this}},x.pop=function(t){var e;return typeof t==m?((e=_[t])||(_[t]=e=new x,e.constant("BOTTLE_NAME",t)),e):new x},x.clear=function(t){typeof t==m?delete _[t]:_={}},x.list=v,x.config={strict:!1};var t,B,E,M,A,T={function:!0,object:!0};t=T[typeof window]&&window||this,B=T[typeof exports]&&exports&&!exports.nodeType&&exports,E=T[typeof module]&&module&&!module.nodeType&&module,M=E&&E.exports===B&&B,!(A=T[typeof global]&&global)||A.global!==A&&A.window!==A||(t=A),typeof define==w&&"object"==typeof define.amd&&define.amd?(t.Bottle=x,define(function(){return x})):B&&E?M?(E.exports=x).Bottle=x:B.Bottle=x:t.Bottle=x}).call(this);
//# sourceMappingURL=bottle.min.js.map